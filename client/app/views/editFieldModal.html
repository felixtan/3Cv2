<link rel="stylesheet" href='styles/forms.scss'>
<link rel='stylesheet' href='styles/addFieldModal.css'>

<div class="modal-header">
    <h3 class="modal-title">Edit field</h3>
    <button type="button" class='close' ng-click='close()' style='margin-top:-35px;'>
        &times;
    </button>
</div>
<!-- {{ formData }} -->
<div class="modal-body">
    <form novalidate role='form' name='form' ng-submit='submit()'>

        <!-- <div class='form-group' ng-if='objectType === "prospect" && field.name === "status"'>
            <label for='status'>Status</label>

            <input id='{{ ::field.name }}' data-dataType='{{ ::field.dataType }}' data-fieldType='{{ ::field.type }}' name='fieldName' type='text' class='form-control' ng-model='field.value' ng-required='true'>
        </div> -->

        <div class='form-group'>
            <label for='fieldName'>Name</label>

            <input id='{{ ::field.name }}' data-dataType='{{ ::field.dataType }}' data-fieldType='{{ ::field.type }}' name='fieldName' type='text' class='form-control' ng-model='field.name' ng-required='true' ng-pattern="/^[a-zA-Z0-9_]*$/" ng-if='!dontEditFieldName(field.name)'>

            <p ng-if='dontEditFieldName(field.name)'>{{ ::field.name.capitalizeIfStatus() }}</p>
        </div>

        <div class='form-group' ng-if='isProspectStatus(field.name)'>
            <label for='fieldValue'>Value</label>
            {{ field.value }}
            <select id='{{ ::field.name }}' data-dataType='{{ ::field.dataType }}' data-fieldType='{{ ::field.type }}' type='text' class='form-control' ng-model='field.value' ng-required='true' ng-options='status.value for status in statuses' name='textField'></select>
        </div>

        <div class='form-group' ng-if='field.type === "text"' ng-hide="isProspectStatus(field.name)">
            <label for='fieldValue'>Value</label>

            <input id='{{ ::field.name }}' data-dataType='{{ ::field.dataType }}' data-fieldType='{{ ::field.type }}' name='textField' type='text' class='form-control' ng-model='field.value' ng-required='true'>
        </div>

        <div class='form-group' ng-if='field.type === "number"'>
            <label for='fieldValue'>Value</label>

            <input id='{{ ::field.name }}' data-dataType='{{ ::field.dataType }}' data-fieldType='{{ ::field.type }}' name='numberField' type='text' class='form-control' ng-model='field.value' ng-required='true' ng-pattern='/^[-+]?([0-9]*\.[0-9]+|[0-9]+)$/'>
        </div>

        <div class='form-group' ng-if='field.type === "boolean"'>
            <label for='fieldValue'>Value</label>
            <br>
            <input bs-switch
                ng-model='field.value'
                type="checkbox"
                switch-on-text="Yes"
                switch-off-text="No"
                switch-label=""
                switch-inverse='true'
                switch-off-color='primary'
                class='boolean-field-switch'
                id='{{ ::field.name }}'
                name='booleanField'
                data-dataType='{{ ::field.dataType }}'
                data-fieldType='{{ ::field.type }}' >
                <!-- {{ formData[field].value }} -->
        </div>

        <div class='form-group' ng-if='loggable(field.name)'>
            <label for='logValue'>Log?</label>
            <br>
            <input bs-switch
                ng-model='field.log'
                type="checkbox"
                switch-on-text="Yes"
                switch-off-text="No"
                switch-label=""
                switch-inverse='true'
                switch-off-color='primary'
                class='boolean-field-switch'
                id='{{ ::field.name }}'
                name='logValue'
                data-dataType='{{ ::field.dataType }}'
                data-fieldType='{{ ::field.type }}'
                switch-active='{{ validExpression.value }}'
                ng-change="logValueChanged.value = !logValueChanged.value" >
        </div>

        <div class='form-group' ng-if='(objectType === "car") || (objectType === "asset")'>
            <label>Identify {{  object.assetType.value || objectType }}<span ng-if='!object.assetType.value'>s</span> with this field</label>
            <br>
            <input bs-switch
                ng-model='field.identifier'
                type="checkbox"
                switch-on-text="Yes"
                switch-off-text="No"
                switch-label=""
                switch-inverse='true'
                switch-off-color='primary'
                class='boolean-field-switch'
                id='{{ ::field.name }}'
                name='identifierValue'
                data-dataType='{{ ::field.dataType }}'
                data-fieldType='{{ ::field.type }}'
                switch-active='{{ !field.identifier }}' >
        </div>

        <div ng-messages="form.fieldName.$error" ng-show='form.fieldName.$invalid' class="alert alert-danger" role="alert">
            <div>
                Field must
                <ul>
                    <li>be alphanumeric</li>
                    <li>contain no special characters except _</li>
                    <li>contain no spaces</li>
                </ul>
            </div>
        </div>

        <div id='number-field-error-msg' ng-messages="form.numberField.$error" ng-show='form.numberField.$dirty && form.numberField.$invalid' class="alert alert-danger" role="alert">
            <p>
                Error: Non-number entered into number field.
            </p>
        </div>

        <div id='field-name-exists-msg' ng-messages="form.fieldName.$error" ng-show='form.fieldName.$dirty && fieldNameAlreadyExists()' class="alert alert-danger" role="alert">
            <p>
                Error: Field name already exists.
            </p>
        </div>

    </form>
</div>

<div class="modal-footer" popover="Please change the identifier if you want to delete this field." popover-enable='field.identifier' popover-trigger='mouseenter' popover-placement='bottom-left'>
    <button class='btn btn-danger' type='button' ng-click='delete()' style='float: left;' ng-disabled='field.identifier'>DELETE</button>
  <button class="btn btn-success" type="button" ng-click="submit()" ng-disabled='form.fieldName.$invalid || form.numberField.$invalid || invalidFieldType() || fieldNameAlreadyExists()'>Submit</button>
    <!-- {{ form.fieldName.$invalid }}
    {{ form.numberField.$invalid }}
    {{ !validExpression.value }}
    {{ invalidFieldType() }}
    {{ emptyExpression() }}
    {{ fieldNameAlreadyExists() }} -->
  <button class="btn btn-danger" type="button" ng-click="reset()">Reset</button>
  <button class='btn btn-default' type='button' ng-click='close()'>Close</button>
</div>
