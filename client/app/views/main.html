<!-- <button type='button' class='btn btn-default' ng-click='carListCollapsed = !carListCollapsed'>Toggle Collapse</button> -->

<!-- Collapsed car list becomes a button -->
<div class='col-md-offset-2 col-md-1 col-collapsed' ng-show='carListCollapsed' ng-click='carListCollapsed = !carListCollapsed' type='button'>
  <div class='row row-collapsed'>
    <p class='fa fa-caret-right fa-3x btn-expand'></p>
  </div>
</div>

<!-- Collapsed prospect list becomes a button -->
<div class='col-md-offset-11 col-md-1 col-collapsed' ng-show='prospectListCollapsed' ng-click='prospectListCollapsed = !prospectListCollapsed' type='button'>
  <div class='row row-collapsed'>
    <p class='fa fa-caret-left fa-3x btn-expand'></p>
  </div>
</div>

<div ng-class="{ 'col-md-9' : prospectListCollapsed, 'col-md-5' : !prospectListCollapsed  }" class='col-md-offset-2 col-collapsible' id='car-list' ng-model='cars' collapse='carListCollapsed'>
  
  <h2 class='sub-header'>
    Cars
    <span class='btn-collapse' ng-show='!prospectListCollapsed'>
      <i class='fa fa-caret-left btn-collapse' type='button' ng-click='carListCollapsed = !carListCollapsed'></i>
    </span>
  </h2>  

  <div class='row'>
    <div class='col-md-5 car-actions' ng-controller="CarFormModalCtrl">
      <button type='button' class='btn btn-success' data-toggle='modal' ng-click='open(lg)'>+</button>
    </div>
  </div>

  <div class="table-responsive car" ng-repeat='car in cars'>
    <table class="table">
      <tbody>
        <div class="table-responsive">
          <table class="table">
            <thead>
              <h3>
                <span class='drag-handle-car'>
                  ::
                </span> 
                <span ng-class="{'bg-danger' : car.oilChangeRequired}">{{ car.tlcNumber }}</span>
                <span>
                  <button class='btn btn-xs btn-warning' ng-click='main.oilChanged(car.id)' ng-show='car.oilChangeRequired'>
                    Oil Changed
                  </button>
                </span>
              </h3>
              <th></th>
              <th>Name</th>
              <th>Gas Card</th>
              <th>EZ Pass</th>
              <th ng-show='prospectListCollapsed'>TLC</th>
              <th>Notes</th>
              <th ng-show='prospectListCollapsed'>DMV</th>
              <th ng-show='prospectListCollapsed'>Points</th>
              <th ng-show='prospectListCollapsed'>Accidents</th>
              <th>Shift</th>
              <th ng-show='prospectListCollapsed'>Address</th>
            </thead>
            <tbody class='driver-list' data-list='driver' data-carid='{{ car.id }}' ng-model='car.Drivers'>
              <tr class='dropfix'>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr class='driver-row' ng-repeat='driver in car.Drivers' data-id='{{ driver.id }}' data-currentCarId='{{ car.id }}'>
                <td>
                  <ul class='row-actions'>
                    <li class='drag-handle' ng-show='!driverRowForm.$visible'>::</li>
                    <li class='filler'> </li>
                    <li type='button' class='fa fa-pencil-square-o' ng-click='driverRowForm.$show()' ng-show="!driverRowForm.$visible && prospectListCollapsed">
                    </li>
                    <li>
                      <form editable-form name='driverRowForm' ng-show='driverRowForm.$visible' class='form-buttons'>
                        <button class='btn btn-xs btn-warning' type='submit' ng-disabled='driverRowForm.$waiting'>
                          Save
                        </button>
                        <button class='btn btn-xs btn-danger'type='button' ng-click='deleteRow(driver)'>
                          Del
                        </button>
                      </form>
                    </li>
                  </ul>
                </td>
                <td>
                  <span editable-text='driver.name' buttons='no' e-name='name' e-form='driverRowForm' onaftersave='updateRow(driver)' e-ng-keypress="keypress($event, driverRowForm)">
                    {{ driver.name }}
                  </span>
                </td>
                <td>
                  <span editable-select='driver.gasCardId' e-ng-options='card.id as card.number for card in gasCards' e-form='driverRowForm'>
                  </span>
                  <span ng-show='!driverRowForm.$visible'>
                    {{ driver.GasCards[0].number }}
                  </span>
                </td>
                <td>
                  <span editable-select='driver.ezPassId' e-ng-options='pass.id as pass.number for pass in ezPasses' e-form='driverRowForm'>
                  </span>
                  <span ng-show='!driverRowForm.$visible'>
                    {{ driver.EzPasses[0].number }}
                  </span>
                </td>
                <td ng-show='prospectListCollapsed'>
                  <span editable-text='driver.tlc' e-name='tlc' e-form='driverRowForm'>
                    {{ driver.tlc }}
                  </span>
                </td>
                <td>
                  <span editable-text='driver.description' e-name='description' e-form='driverRowForm'>{{ driver.description }}
                  </span>
                </td>
                <td ng-show='prospectListCollapsed'>
                  <span editable-text='driver.dmv' e-name='dmv' e-form='driverRowForm'>
                    {{ driver.dmv }}
                  </span>
                </td>
                <td ng-show='prospectListCollapsed'>
                  <span editable-text='driver.points' e-name='points' e-form='driverRowForm'>
                    {{ driver.points }}
                  </span>
                </td>
                <td ng-show='prospectListCollapsed'>
                  <span editable-text='driver.accidents' e-name='accidents' e-form='driverRowForm'>
                    {{ driver.accidents }}
                  </span>
                </td>
                <td>
                  <span editable-text='driver.shift' e-name='shift' e-form='driverRowForm'>
                    {{ driver.shift }}
                  </span>
                </td>
                <td ng-show='prospectListCollapsed'>
                  <span editable-text='driver.address' e-name='address' e-form='driverRowForm'>
                    {{ driver.address }}
                  </span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </tbody>
    </table>
  </div>
</div>

<div ng-class="{ 'col-md-offset-3' : carListCollapsed, 'col-md-9' : carListCollapsed, 'col-md-5' : !carListCollapsed }" id='prospect-list' ng-model='prospects' collapse='prospectListCollapsed' class='col-collapsible'>
  <h2 class='sub-header'>
    Prospects
    <span class='btn-collapse' ng-show='!carListCollapsed'>
      <i class='fa fa-caret-right' type='button' ng-click='prospectListCollapsed = !prospectListCollapsed'></i>
    </span>
  </h2>
  <div class='row'>
    <div class='col-md-5 prospect-actions' ng-controller="ProspectFormModalCtrl">
      
      <button type='button' class='btn btn-success' data-toggle='modal' ng-click='open(lg)'>+</button>
    </div>
  </div>
  <div class='table-responsive' ng-repeat='status in prospectStatuses'>
    <table class='table'>
      <thead>
        <h3>{{ status }}</h3>
        <th></th>
        <th>Name</th>
        <th>TLC</th>
        <th>Notes</th>
        <th>DMV</th>
        <th>Points</th>
        <th>Accidents</th>
        <th>Shift</th>
        <th>Address</th>
      </thead>
      <tbody class='prospect-status' data-status='{{ status }}' data-list='prospect'>
          <tr class='dropfix'>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr ng-repeat="prospect in prospects | filter:status" data-id='{{ prospect.id }}' data-status='{{ prospect.status }}' repeat-finished>
            <td>
              <ul class='row-actions'>
              <li class='drag-handle' ng-show='!prospectRowForm.$visible'>::</li>
              <li class='filler'> </li>
              <li type='button' class='fa fa-pencil-square-o' ng-click='prospectRowForm.$show()' ng-show="!prospectRowForm.$visible && carListCollapsed">
              </li>  
              <li>
                <form editable-form name='prospectRowForm' ng-show='prospectRowForm.$visible' class='form-buttons'>
                  <button class='btn btn-xs btn-warning' type='submit' ng-disabled='prospectRowForm.$waiting'>
                    &#10003;
                  </button>
                  <button class='btn btn-xs btn-danger'type='button' ng-click='deleteRow(prospect)'>
                    &times;
                  </button>
                </form>
              </li>
            </ul>
            </td>
            <td>
              <span editable-text='prospect.name' buttons='no' e-name='name' e-form='prospectRowForm' onaftersave='updateRow(prospect)' e-ng-keypress="keypress($event, prospectRowForm)">
                {{ prospect.name }}
              </span>
            </td>
            <td>
              <span editable-text='prospect.tlc' e-name='tlc' e-form='prospectRowForm'>
                {{ prospect.tlc }}
              </span>
            </td>
            <td>
              <span editable-text='prospect.description' e-name='description' e-form='prospectRowForm'>
                {{ prospect.description }}
              </span>
            </td>
            <td>
              <span editable-text='prospect.dmv' e-name='dmv' e-form='prospectRowForm'>
                {{ prospect.dmv }}
              </span>
            </td>
            <td>
              <span editable-text='prospect.points' e-name='points' e-form='prospectRowForm'>
                {{ prospect.points }}
              </span>
            </td>
            <td>
              <span editable-text='prospect.accidents' e-name='accidents' e-form='prospectRowForm'>
                {{ prospect.accidents }}
              </span>
            </td>
            <td>
              <span editable-text='prospect.shift' e-name='shift' e-form='prospectRowForm'>
                {{ prospect.shift }}
              </span>
            </td>
            <td>
              <span editable-text='prospect.address' e-name='address' e-form='prospectRowForm'>
                {{ prospect.address }}
              </span>
            </td>
          </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Prospect form modal view -->
<!-- TODO: put it in a different file -->
<script type="text/ng-template" id="newprospectformmodal">
  <div class="modal-header">
      <h3 class="modal-title">Add Caller</h3>
      <button type="button" class='close' ng-click='close()' style='margin-top:-35px;'>&times;</button>
  </div>
  <div class="modal-body">
    <form novalidate role='form' id='newProspectForm'>
      <div class='form-group'>
        <label for='givenName'>First</label>
        <input type='text' class='form-control' ng-model='formData.givenName' placeholder='John'>
      </div>
      <div class='form-group'>
        <label for='surName'>Last</label>
        <input type='text' class='form-control' ng-model='formData.surName' placeholder='Doe'>
      </div>
      <div class='form-group'>
            <label for='email'>Email</label>
            <input type='text' class='form-control' ng-model='formData.email' placeholder=''>
        </div>
        <div class='form-group'>
            <label for='phoneNumber'>Phone Number</label>
            <input type='text' class='form-control' ng-model='formData.phoneNumber' placeholder=''>
        </div>
        <div class='form-group'>
            <label for='address'>Address</label>
            <input type='text' class='form-control' ng-model='formData.address' placeholder=''>
        </div>
        <div class='form-group'>
            <label for='driversLicenseNum'>Driver License Number</label>
            <input type='text' class='form-control' ng-model='formData.driversLicenseNum' placeholder=''>
        </div>
        <div class='form-group'>
          <label for='tlc'>TLC</label>
          <input type='text' class='form-control' ng-model='formData.tlc'>
        </div>
        <div class='form-group'>
          <label for='dmv'>DMV</label>
          <input type='text' class='form-control' ng-model='formData.dmv'>
        </div>
        <div class='form-group'>
          <label for='points'>Points</label>
          <input type='text' class='form-control' ng-model='formData.points'>
        </div>
        <div class='form-group'>
          <label for='accidents'>Accidents</label>
          <input type='text' class='form-control' ng-model='formData.accidents'>
        </div>
        <div class='form-group'>
          <label for='shift'>Shift</label>
          <input type='text' class='form-control' ng-model='formData.shift'>
        </div>
        <div class='form-group'>
          <label for='paperwork'>Paperwork</label>
          <input type='text' class='form-control' ng-model='formData.paperwork'>
        </div>
        <label for='description'>Description</label>
        <textarea ng-model='formData.description' type='text' class='form-control' rows='5'>
        </textarea>
    </form>
  </div>
  <div class="modal-footer">
      <button class="btn btn-success" type="button" ng-click="submit()">Submit</button>
      <button class="btn btn-danger" type="button" ng-click="reset()">Reset</button>
      <button class='btn btn-default' type='button' ng-click='close()'>Close</button>
  </div>
</script>

<!-- Car form modal view -->
<!-- TODO: put it in a different file -->
<script type="text/ng-template" id="carformmodal">
  <div class="modal-header">
      <h3 class="modal-title">Add Car</h3>
      <button type="button" class='close' ng-click='close()' style='margin-top:-35px;'>&times;</button>
  </div>
  <div class="modal-body">
    <form novalidate role='form' id='newCarForm'>
      <div class='form-group'>
        <label for='tlcNumber'>TLC Number</label>
        <input type='text' class='form-control' ng-model='formData.tlcNumber'>
      </div>
      <div class='form-group'>
        <label for='licensePlateNumber'>License Plate Number</label>
        <input type='text' class='form-control' ng-model='formData.licensePlateNumber'>
      </div>
      <div class='form-group'>
            <label for='mileage'>Mileage</label>
            <input type='text' class='form-control' ng-model='formData.mileage' placeholder=''>
      </div>
      <div class='form-group'>
        <label for='driver'>Driver</label>
        <select class='form-control' ng-model='formData.driverId' placeholder='Select Driver'>
            <option> - </option>
            <option ng-repeat='driver in drivers' value='{{ driver.id }}'>{{ driver.givenName }} {{ driver.surName }}</option>
        </select>
      </div>
      <label for='description'>Description</label>
      <textarea ng-model='formData.description' type='text' class='form-control' rows='5'>
      </textarea>
    </form>
  </div>
  <div class="modal-footer">
      <button class="btn btn-success" type="button" ng-click="submit()">Submit</button>
      <button class="btn btn-danger" type="button" ng-click="reset()">Reset</button>
      <button class='btn btn-default' type='button' ng-click='close()'>Close</button>
  </div>
</script>

<!-- Pay rate modal view -->
<!-- TODO: put it in a different file -->
<script type="text/ng-template" id="payRateModal">
  <div class='modal-header'>
    <h3 class="modal-title">Enter Pay Rate</h3>
    <button type="button" class='close' ng-click='close()' style='margin-top:-35px;'>&times;</button>
  </div>
  <div class='modal-body'>
    <form novalidate role='form' name='payRateForm'>
      <div class='form-group'>
        <label for='payRate'>Pay Rate (%)</label>
        <input type='text' class='form-control' ng-model='payRate'>
      </div>
    </form>
  </div>
  <div class='modal-footer'>
    <button class="btn btn-success" type="button" ng-click="submit()">Submit</button>
    <button class='btn btn-default' type='button' ng-click='close()'>Close</button>
  </div>
</script>