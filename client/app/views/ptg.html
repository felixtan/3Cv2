<link rel="stylesheet" href="styles/partials/_ptg.css">

<div class='col-md-10 col-md-offset-2 col-sm-offset-3'>
  <h1 class="page-header">Driver Payout Record</h1>

  <div class='sub-header'>
    <button class='btn btn-success' ng-click='ptg.newLog()'> Add Row </button>
  </div>

  <div class="table-responsive">
    <table class="table table-bordered table-striped table-hover">
      <thead ng-model='drivers'>
        <tr>
          <td><strong>Week \ Driver</strong></td>
          <td ng-repeat="driver in drivers | orderBy:'id'">{{ driver.givenName }} {{driver.surName}}</td>
        </tr>
      </thead>
      <tbody ng-model='logs'>
        <tr ng-repeat="ptgLog in logs | orderBy:'-dateInMs'">
          <td>
            <span>{{ ptgLog.date | date : format : shortDate }}</span>
            <button class='btn btn-warning btn-xs edit-btn' ng-click='rowform.$show()' ng-show='!rowform.$visible'>
              Edit
            </button>
            <form editable-form name="rowform" ng-show="rowform.$visible" class="form-buttons form-inline" shown="false">
              <button type="submit" ng-disabled="rowform.$waiting" class="btn btn-primary btn-xs">
                Save
              </button>
              <button type="button" ng-disabled="rowform.$waiting" ng-click="rowform.$cancel()" class="btn btn-default btn-xs">
                Cancel
              </button>
            </form>
          </td>
          <td class='log-tablecell' ng-repeat="driver in ptgLog.DriverLogs | orderBy:'driverId'">
            
            <!-- editable driver log (text with validation) -->
            <ul class='log'>
              <li>
                <p ng-show='rowform.$visible'>Uber: $</p>
                <span editable-text='driver.uberRevenue' e-name='uberRevenue' e-form='rowform' onaftersave='updateLog(driver)' e-required>
                  Uber: ${{ driver.uberRevenue || ' ' }}
                </span>
              </li>
              <li>
                <p ng-show='rowform.$visible'>Tolls: $</p>
                <span editable-text='driver.tollCosts' e-name='tollCosts' e-form='rowform' e-required>
                  Tolls: ${{ driver.tollCosts || ' ' }}
                </span>
              </li>
              <li>
                <p ng-show='rowform.$visible'>Gas: $</p>
                <span editable-text='driver.gasCosts' e-name='gasCosts' e-form='rowform' e-required>
                  Gas: ${{ driver.gasCosts || ' ' }}
                </span>
              </li>
              <li>
                <p ng-show='rowform.$visible'>Deposit: $</p>
                <span editable-text='driver.deposit' e-name='deposit' e-form='rowform' e-required>
                  Deposit: ${{ driver.deposit || ' ' }}
                </span>
              </li>
              <li>
                <p ng-show='rowform.$visible'>Hours:</p>
                <span editable-text='driver.hours' e-name='hours' e-form='rowform' e-required>
                  Hours: {{ driver.hours || ' ' }}
                </span>
              </li>
              <li>
                <p ng-show='rowform.$visible'>Acceptance: %</p>
                <span editable-text='driver.acceptRate' e-name='acceptRate' e-form='rowform' e-required>
                  Acceptance: {{ driver.acceptRate || ' ' }}%
                </span>              
              </li>
              <li>
                <p ng-show='rowform.$visible'>Additions: </p>
                <span editable-text='driver.additions' e-name='additions' e-form='rowform' e-required>
                  Additions: ${{ driver.additions || ' ' }}
                </span>              
              </li>
              <li>
                <p ng-show='rowform.$visible'>Subtractions: </p>
                <span editable-text='driver.subtractions' e-name='subtractions' e-form='rowform' e-required>
                  Subtractions: ${{ driver.subtractions || ' ' }}
                </span>              
              </li>
              <li>
                <p ng-show='rowform.$visible'>Payout: </p>
                <span editable-text='driver.payout' e-name='payout' e-form='rowform' e-required>
                  Payout: ${{ driver.payout || ' ' }} <button type='button' class='btn btn-xs btn-info calculate' ng-click='ptg.calculatePayout(driver)'>Calculate</button>
                </span>              
              </li>
              <li>
                <p ng-show='rowform.$visible'>Profit: </p>
                <span editable-text='driver.profit' e-name='profit' e-form='rowform' e-required>
                  Profit: ${{ driver.profit || ' ' }} <button type='button' class='btn btn-xs btn-info calculate' ng-click='ptg.calculateProfit(driver)'>Calculate</button>
                </span>              
              </li>
            </ul>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
<!-- ng-repeat="driverLog in ptgLog.DriverLogs | orderBy:'driverLog.givenName'" -->